# PM 與客戶確認事項 Checklist

> 說明：
> - 【確認】項目：來自現有文件，需與客戶確認規則或決策
> - 【建議】項目：Agent 補充之潛在缺漏功能，需 PM / 主管評估是否納入

## 一、名詞與狀態定義（確認）
- [ ] 「內部廠區」的定義與資料來源為何？是否存在跨廠區支援/切換情境？（來源：PRD FR5、PRD「Technical Constraints > 身份驗證與權限控制」）
- [ ] 「碼頭」的啟用/停用（ON/OFF）在前台呈現與可用性規則為何？停用中的碼頭是否仍需顯示歷史資料？（來源：PRD FR15、PRD FR66.2）
- [ ] 出貨作業的「班別（早班/午班/晚班）」是否固定三種？是否允許後台擴增或不同廠區有不同班別？（來源：PRD「3.1 篩選列」）
- [ ] 「車次」與「固定路線」的關係與命名規則為何？車次代號是否唯一（跨日期/跨廠區/跨路線）？（來源：PRD FR17、PRD「3.2 碼頭儀錶板 > 車次定義」）
- [ ] 配送任務（車輛任務）狀態集合與狀態意義是否以「待出貨 / 碼頭處理中 / 配送中 / 缺貨待料 / 通知未到 / 配送異常 / 配送完成」為準？是否還有其他狀態？（來源：PRD「Domain Patterns > 狀態機模式」、PRD「3.3 未排車次列表」）
- [ ] 「完成出車」與「取消」在狀態上都會進到「配送中」：這兩個動作在業務意義上如何區分（例如是否需要不同的原因碼/操作記錄）？（來源：PRD FR21、PRD「3.2 碼頭儀錶板 > 車次狀態修改」）
- [ ] 「缺貨待料」「通知未到」這兩個狀態是否都屬於異常分支？是否需要原因、預計處理時間或解除/回復規則？（來源：PRD FR21、PRD「Domain Patterns > 狀態機模式」）
- [ ] 收貨作業「下貨狀態」是否固定為「接貨中 / 回廠下貨 / 下貨完成」？是否需要額外狀態（例如「待簽名」「簽名中」「作廢」）？（來源：PRD FR28、PRD「4.1 收貨列表頁 > 下貨狀態」）
- [ ] 「收貨類型（入庫分貨／越庫作業）」由後台在配送任務建立時寫入：其判定規則與後台欄位名稱為何？（來源：PRD「4.2 配送點總表」、PRD FR35、PRD FR69.5）
- [ ] 退貨「退貨類型（直退／回廠退／彙整單）」與「狀態（未完成／已彙整／待立單／已立單）」的狀態機與可操作範圍是否有完整定義？（來源：PRD「5.1 退貨單列表頁」、PRD FR53–FR58）
- [ ] 退貨單號（B...）與彙整單號（BA...）編碼規則中的「流水號」重置範圍（每日/每廠區/全系統）為何？（來源：PRD「5.1 退貨單列表頁 > 產生退貨彙整單號規則」、PRD「6.2 異常回報 > 退貨」）
- [ ] 公告狀態「已讀/未讀」的定義：是否以「人」為維度？是否需要已讀時間/已讀裝置等欄位？（來源：PRD FR14、PRD「2.1 公告列表頁」）

## 二、流程與操作規則（確認）
- [ ] 登入驗證失敗訊息固定為「帳號密碼輸入錯誤」：是否需涵蓋帳號停用、密碼錯誤、後台服務不可用等情境？（來源：PRD「1.1 登入/登出功能」、Epics Story 2.2）
- [ ] 會話逾時自動登出的逾時時間（例如 15/30/60 分鐘）與續期策略為何？（來源：PRD「Security > 會話管理」、Epics Story 2.4）
- [ ] 忘記密碼燈箱文案由後台「碼頭-忘記密碼」提供：是否需要多語系、版本控管或顯示條件（依廠區/依角色）？（來源：PRD「1.1 忘記密碼」、PRD FR77、Epics Story 2.3）
- [ ] 公告列表的「全部已讀/全部刪除」是否需要二次確認？是否需要顯示影響筆數？（來源：PRD「2.1 公告列表頁」、Epics Story 3.5、Story 3.7）
- [ ] 公告的「刪除」是否為軟刪除（可復原）或硬刪除？刪除權限與保留期限為何？（來源：PRD「2.2 公告詳細頁」、Epics Story 3.6）
- [ ] 出貨作業：將車次加入碼頭後狀態改為「碼頭處理中」，是否需要防止同一車次被多個碼頭同時選取？衝突時 UI 與後端回應規則為何？（來源：PRD FR19、PRD「資料不一致風險」）
- [ ] 出貨作業：車次詳細燈箱的資料（配送點、配送單、商品、載具、備註）更新頻率與即時同步範圍為何？（來源：PRD FR20、PRD「即時功能範圍」）
- [ ] 點擊通知圖示發送通知給運務：通知內容、通道（推播/站內信/簡訊）、去重規則（短時間多次點擊）為何？（來源：PRD FR25.1、PRD「運務 APP 整合 > 推播通知機制」、Epics Story 4.3）
- [ ] 「通知未到」會通知運務員及運務部主管：主管名單來源、通知頻率/重試、是否需回覆/回報機制為何？（來源：PRD FR25.2、PRD「即時性風險 > 重試機制」）
- [ ] 收貨作業：回廠下貨後可選擇下貨碼頭，且需排除已選定出貨/下貨的碼頭；排除規則是否含跨任務占用、時間窗、或僅同時段？（來源：PRD FR31–FR32、PRD「4.1 下貨碼頭選擇」）
- [ ] 收貨作業：簽名送出後狀態改為「下貨完成」且不可再進入配送點總表；是否需要例外（例如退回重簽、主管解鎖）？（來源：PRD FR38–FR39、PRD「4.2 簽名板功能」）
- [ ] 入庫分貨：實收數量預設同單據入數，可新增多組且最少保留一組；「多組」的使用情境（批次/效期/拆箱）是否需明確說明？（來源：PRD「4.3.1 入庫分貨」、PRD FR45–FR46）
- [ ] 越庫作業：單一商品可新增多組配送點/實收板位/配送日期/備註且最少保留一組；多組的排序與輸出（列印/匯出/回寫）規則為何？（來源：PRD「4.3.2 越庫作業」、PRD FR49–FR50）
- [ ] 退貨彙整：需同客戶簡稱與溫層且狀態為未完成；若單張可建立彙整單，是否仍需同樣驗證？（來源：PRD「5.1 [彙整退貨單]按鈕」、PRD FR55–FR55.2）
- [ ] 退貨彙整後「原退貨單狀態變為已彙整」：是否需要保留原單的可追溯關聯與合併前內容？（來源：PRD FR55.5、PRD「資料追溯」）
- [ ] 退貨編輯頁：檔案上傳可多檔且預設帶入異常回報圖片；是否需限制檔案大小/數量，與刪除/替換規則？（來源：PRD「5.2 退貨單編輯頁」、PRD FR56.4）
- [ ] 退貨作業送出驗證（起點/迄點數量總和比對）：比對範圍（同一組起點/同商品）與「起點/迄點」欄位定義需與客戶確認（來源：PRD FR84）

## 三、跨文件一致性（確認）
- [ ] PRD 中「取消」會將車輛任務狀態改為「配送中」：是否與業務認知一致，或需要不同狀態/不同後續流程？（來源：PRD FR21、PRD「3.2 車次狀態修改」 vs Epics Story 4.5）
- [ ] PRD 說明「無特定審計要求」，但同時在安全/稽核要求與 Epic 9 中要求狀態變更記錄與可追溯：稽核日誌的保存與查詢需求是否需要明確化？（來源：PRD「Compliance & Regulatory」、PRD「Security > 安全審計」、Epics Epic 9）
- [ ] 出貨/收貨/退貨多處要求「即時同步（<3 秒）」：哪些欄位/哪些頁面必須即時、哪些可接受延遲或輪詢？（來源：PRD FR59–FR65、PRD「即時功能範圍」 vs Epics Epic 7）
- [ ] 運務 APP「回廠下貨」後，PRD 要求轉換經緯度為地址並顯示：是否需要與 Epics 的資料模型一致（回報時間、位置、地址欄位）？（來源：PRD「6.1 回廠下貨功能」 vs Epics Story 5.3）
- [ ] 退貨來源包含「運務 APP 異常回報-退貨」與「後台新增」：兩者欄位差異、必填規則、以及前台合併顯示是否已對齊？（來源：PRD「5.1 資料來源」、PRD「6.2 異常回報 > 退貨」 vs Epics Story 6.1）
- [ ] 後台可修改前台資料（依權限）且需標記是否異動：前台是否需要提示「資料已被後台異動」的 UX 規則？（來源：PRD FR71、PRD FR69.7）

## 四、業務決策點（確認）
- [ ] 出貨作業：未排車次列表的「顯示/不顯示」條件含狀態排除（碼頭處理中/配送中/配送異常/配送完成）；是否需要加入其他排除（例如已取消、已結案）？（來源：PRD FR24、PRD「3.3 不顯示條件」）
- [ ] 出貨作業：車次底色（綠/藍/紅）是否需符合無障礙對比與色弱輔助（例如加 icon/文字）？（來源：PRD FR25、PRD「Accessibility」）
- [ ] 出貨作業：通知發送的觸發條件為何（只能在某些狀態/時間窗）？是否需要限制每天/每車次的通知次數？（來源：PRD FR25.1、PRD「即時性風險」）
- [ ] 收貨列表排序規則（先回廠下貨再接貨中，同狀態依回報時間新到舊）：是否需要把「下貨完成」顯示在列表中？若顯示，排序位置為何？（來源：PRD FR34、PRD「4.1 列表排序」）
- [ ] 收貨作業：選擇下貨碼頭後是否需要立即推播通知運務？若推播失敗，是否允許重送/改選？（來源：PRD「6.1 後端連動 > 發送自動通知」、Epics Story 5.4）
- [ ] 簽名板：簽名是否需要姓名/工號/時間戳、簽名失敗重送機制、以及簽名資料的法律/稽核需求？（來源：PRD FR37–FR38、PRD「敏感資料保護：簽名資料需加密儲存」）
- [ ] 退貨操作：狀態為「已彙整」或「已立單」的查看頁為唯讀；是否需要允許特定角色在特殊情境下修正？（來源：PRD「5.1 操作按鈕」、PRD FR57–FR58）
- [ ] 退貨彙整單的「原退貨單號」欄位是否支援多筆？前台查看/編輯頁的呈現形式為何？（來源：PRD「5.4 彙整單編輯頁」、PRD FR57.1）

## 五、例外與錯誤處理（確認）
- [ ] 登入失敗時「不洩露帳號是否存在」：錯誤訊息與錯誤碼策略是否有明確規範？（來源：Epics Story 2.2、PRD「Security」）
- [ ] 即時連線中斷時的 UI 呈現：哪些操作要禁止、哪些可暫存、恢復後的同步/衝突解決策略為何？（來源：PRD FR62、PRD「容錯與恢復」、Epics Story 7.4、7.8）
- [ ] 通知推播失敗時的重試/降級方案（例如改站內信、輪詢）：失敗定義、重試次數、以及告警/日誌規則為何？（來源：PRD「即時性風險 > 重試機制」、Epics Story 7.9）
- [ ] 出貨狀態變更（完成出車/取消/缺貨待料/通知未到）若遇到後端拒絕（權限不足/狀態已變更）時，前台提示與回復 UI 狀態規則為何？（來源：PRD「資料不一致風險」、Epics Story 4.10）
- [ ] 收貨明細的「實收數量不能為負數」等驗證：是否還需要上限、允許 0、以及小數/單位換算規則？（來源：PRD「人為錯誤風險 > 資料驗證」、Epics Story 5.12）
- [ ] 多組資料刪除規則（最少保留一組）：當只剩一組時的錯誤訊息文案與行為是否需統一？（來源：PRD FR46、PRD FR50、Epics Story 5.14）
- [ ] 檔案上傳限制（PDF/PNG/JPG）：是否需限制單檔大小、總大小、與檔名/病毒掃描？（來源：PRD「5.2 檔案上傳」、PRD FR56.4）
- [ ] 退貨送出驗證失敗（起點/迄點總和不相符）後，使用者回到哪個畫面、哪些欄位需被標示、是否需保留編輯內容？（來源：PRD FR84）

## 六、跨系統整合與責任歸屬（確認）
- [ ] 系統整合「現有後台系統」：哪些資料是唯一真實來源（碼頭/人員/任務/公告/退貨單）？哪些可由前台寫入？（來源：PRD「與現有系統整合」、PRD FR72）
- [ ] 推播通知的 provider 與責任歸屬（後台/前台/中介服務）為何？通知投遞成功如何被記錄與追蹤？（來源：PRD「運務 APP 整合 > 推播通知機制」、PRD「安全審計」）
- [ ] 運務 APP 回報「回廠下貨」：重複回報、晚到回報、或回報內容缺漏時的處理規則與責任歸屬為何？（來源：PRD FR29–FR30、PRD「整合可靠性」）
- [ ] 「經緯度轉地址」串接 Google Map API：API Key 管理、失敗降級（顯示座標/顯示最後一次成功地址）與費用控管策略為何？（來源：PRD「6.1 回廠下貨功能」）
- [ ] 經緯度資料來源「衛星犬 API」：其 SLA、資料格式、授權與錯誤處理規則為何？（來源：PRD「6.1 回廠下貨功能」）
- [ ] 即時雙向通訊（WSS）與 REST API 的分工：哪些事件走即時通道、哪些走輪詢/查詢？（來源：PRD「即時性需求」、PRD「資料規範」）
- [ ] 操作記錄/審計日誌：哪些操作必記（狀態變更、刪除公告、退貨彙整等）？日誌查詢權限與保留期限為何？（來源：PRD FR74–FR75、PRD「安全審計」、Epics Epic 9）

## 七、潛在缺漏功能與規劃建議（建議）
- [ ] [Agent 補充] 是否需要明確的「角色與權限矩陣」（倉儲人員/後台管理員/主管/運務）對應到各操作（狀態變更、刪除、編輯、解鎖）的允許/禁止？
- [ ] [Agent 補充] 是否需要「狀態變更原因」欄位（例如取消、缺貨待料、通知未到）以利追蹤與報表？
- [ ] [Agent 補充] 是否需要「衝突處理」的使用者提示規範（例如同一任務被兩人同時操作）與統一錯誤碼？
- [ ] [Agent 補充] 是否需要在前台提供「操作歷史/事件時間軸」以支援現場追查（不含新增需求，只確認是否需要可視化）？
- [ ] [Agent 補充] 是否需要公告的「有效期限/置頂/分類」等欄位，以符合實際營運公告管理方式？
- [ ] [Agent 補充] 是否需要提供列表/明細的「匯出」能力（CSV/PDF）以支援稽核或交班？
- [ ] [Agent 補充] 是否需要針對簽名流程增加「簽名人身份確認」（例如輸入工號/選擇司機）以降低冒用風險？
- [ ] [Agent 補充] 是否需要「離線暫存」的明確範圍清單（哪些表單可暫存、多久、恢復後如何提示）？
