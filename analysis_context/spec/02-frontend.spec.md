# 02 前端行為

> 本文件僅描述前端「行為與狀態規則 / UX 約束」，不描述元件實作方式、不輸出程式碼。

## 1) 全域導覽與基本行為
- 登入後預設進入「出貨作業頁面」。
- 所有前台登入後頁面最上方固定顯示功能列，包含：
  - 登出按鈕
  - 即時公告入口（小鈴鐺 icon，可能顯示未讀數量；未讀計算規則未定義）
  - 出貨作業、收貨作業、退貨作業
- 點擊功能項目切換至對應頁面。

## 2) 權限/資料範圍顯示（前台）
- 登入成功後，前台僅顯示「符合登入者所屬內部廠區」的資料（出貨/收貨/退貨等列表與資料載入皆需符合此顯示規則）。
- 內部廠區資料隔離如何在前端呈現錯誤/拒絕情境：未定義（若後端回應不允許，前端需顯示明確提示，文案未定義）。

## 3) 即時公告：前端互動規則
### 3.1 公告列表
- 支援勾選列表項目。
- 支援批量操作（依篩選條件）：
  - 全部已讀：將符合篩選條件的公告標記為已讀
  - 全部刪除：將符合篩選條件的公告刪除
- 支援單筆操作：
  - 標記已讀
  - 刪除
- 列表需顯示公告狀態（已讀/未讀）。

### 3.2 公告詳細
- 顯示公告日期、時間、標題、內容。
- 支援刪除與返回列表。

## 4) 出貨作業：前端互動與狀態呈現
### 4.1 篩選列
- 篩選欄位包含：出貨日期、班別（早班/午班/晚班）。
- 篩選條件僅影響「未排車次列表」，不影響碼頭儀錶板的顯示。

### 4.2 碼頭儀錶板（Dock Dashboard）
- 碼頭來源與顯示範圍：依登入者所屬內部廠區顯示啟用中的碼頭（資料來源與篩選邏輯由後端提供；前端依資料渲染）。
- 未排車次狀態：
  - 顯示「選擇車次」下拉選單
  - 選項格式：[車牌]([車次])(任務單號)
- 已選定車次狀態：
  - 顯示車牌（車次）與通知圖示（喇叭 icon）
  - 點擊喇叭 icon：發送通知並顯示提示文字「已通知司機前往碼頭」
  - 點擊碼頭：開啟「車次詳細配送單燈箱」

### 4.3 狀態視覺化（顏色約束）
- 狀態以「純實色背景」呈現，不顯示文字狀態。
- 顏色規則：
  - 綠色 `#8eba34`：待出貨
  - 藍色 `#3a9cd8`：缺貨待料
  - 紅色 `#f68480`：通知未到
- 狀態變更顏色需即時反映（< 1 秒）。

### 4.4 車次詳細配送單燈箱（Delivery Details Dialog）
- 由點擊碼頭開啟。
- 燈箱顯示：
  - 基本資訊：上班時間、司機姓名、車號車次、路線別
  - 配送資訊：配送點清單（可收合展開）；配送點下可能包含多位客戶的配送單（各自可收合展開）
- 燈箱遮罩：不覆蓋整個頁面，僅在燈箱區域顯示遮罩。
- 狀態修改按鈕位於燈箱最下方（非出貨作業基本頁面），包含：
  - 完成出車、缺貨待料、通知未到、取消
- 操作回饋：
  - 完成出車：顯示提示文字「已完成出車」並關閉燈箱
  - 其他按鈕：關閉燈箱（提示文案是否需要顯示未定義，除「完成出車」外）
- 操作中狀態：
  - 送出中需顯示載入狀態並禁用其他操作（具體載入呈現方式未定義）

### 4.5 未排車次列表
- 列表顯示格式：[車牌]([車次])(任務單號)
- 不顯示條件：任務狀態為「碼頭處理中」、「配送中」、「配送異常」、「配送完成」者不顯示。
- 顏色狀態同「狀態視覺化」規則。

## 5) 收貨作業：前端互動與狀態規則（三級導航）
### 5.1 收貨列表頁
- 列表顯示：所有包含收貨的配送任務；僅顯示符合登入者內部廠區的任務。
- 下貨狀態顯示：
  - 接貨中 / 回廠下貨 / 下貨完成
- 排序規則：
  - 先回廠下貨，再接貨中；同狀態依回報時間由新到舊
  - 「下貨完成」在列表中的呈現與排序位置：未定義（文件僅描述不可點擊車號）
- 導航規則：
  - 接貨中/回廠下貨：車號可點擊，進入配送點總表
  - 下貨完成：車號為純文字不可點擊
- 回廠下貨狀態：可選擇下貨碼頭（需排除已選定出貨和下貨的碼頭；排除細節由後端決定並回傳可選清單）

### 5.2 配送點總表
- 列表顯示：該趟任務所有有收貨的配送單資訊，依客戶與配送點分類，相同配送點排序在一起。
- 收貨類型顯示：
  - 入庫分貨：配送單迄點與登入者內部廠區關聯為入庫分貨配送點
  - 越庫作業：非入庫分貨配送點
- 導航：點擊配送點進入收貨明細。
- 收貨完成：
  - 點擊「收貨完成」後開啟簽名板
  - 簽名送出成功後，該任務收貨狀態更新為「下貨完成」，並跳轉回收貨列表

### 5.3 簽名板（Signature Pad）
- 主要使用於收貨點總表的收貨完成流程。
- 行為狀態：
  - 空白：可繪製簽名
  - 已繪製：可清除或送出
  - 送出中：顯示載入狀態，按鈕禁用
  - 送出成功：關閉簽名板、更新狀態、返回收貨列表
- 送出前驗證規則（例如是否允許空白簽名）：未定義

### 5.4 收貨明細（入庫分貨 / 越庫作業）
- 顯示進入時間並持續動態更新。
- 入庫分貨可編輯：
  - 實收數量、有效日期、備註
  - 可新增多組實收數量與有效日期（最少保留一組）
- 越庫作業可編輯：
  - 實收板位、配送點、配送日期、備註
  - 可新增多組配送點/實收板位/配送日期/備註（最少保留一組）

## 6) 退貨作業：前端互動與顯示規則
### 6.1 退貨列表頁
- 支援搜尋/篩選：關鍵字、建立日期、客戶簡稱、溫層、退貨類型、狀態。
- 顯示規則：
  - 直退：只顯示任務起點內部廠區同登入者所屬廠區的退貨單
  - 回廠退：只顯示退貨廠區同登入者所屬廠區的退貨單
- 彙整退貨單：
  - 僅允許彙整狀態為未完成、且同客戶簡稱與溫層的退貨單
  - 若不符需顯示提示文字：「請選擇同客戶溫層的未完成退貨單」
- 操作入口：
  - 未完成：可編輯（退貨單編輯頁）
  - 待立單：可編輯（彙整單編輯頁）
  - 其他狀態：查看（退貨單查看頁 / 彙整單查看頁）

### 6.2 退貨單編輯/彙整單編輯
- 退貨資料可編輯（數量、備註、商品新增/刪除、檔案上傳）。
- 僅透過「新增商品」新增的商品可刪除。
- 儲存後顯示提示文字「儲存成功」，返回列表。

### 6.3 退貨單查看/彙整單查看
- 僅純顯示，不可編輯。

## 7) 即時同步、載入與斷線提示
- 狀態同步回饋：狀態變更需自動同步（< 3 秒）。
- 網路中斷提示：需要提示使用者（具體提示樣式與阻擋哪些操作未定義）。
- 連線恢復：需要連線恢復機制（具體互動未定義）。

## 8) 無障礙與操作性（來自 UX/PRD 的約束）
- 需支援鍵盤導航與清楚的焦點指示（具體全站規範未定義；Dock Dashboard 與功能列在 UX 中有描述鍵盤行為）。
- 觸控友善需求存在（按鈕與互動元素至少 44x44px；來源：PRD Responsive/UX 原則）。
